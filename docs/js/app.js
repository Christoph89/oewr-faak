"use strict";var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),$oewr;!function(e){!function(e){e[e.WWW=1]="WWW",e[e.Admin=2]="Admin",e[e.Partner=3]="Partner"}(e.Roles||(e.Roles={}));!function(e){e[e.Everyone=0]="Everyone",e[e.Beginner=1]="Beginner",e[e.Advanced=2]="Advanced",e[e.All=3]="All"}(e.MTBLevel||(e.MTBLevel={}))}($oewr||($oewr={}));var $oewr;!function(e){!function(t){function n(e,t){return e.format(t)}function r(e,t,n,r){r&&!i(e,t)&&(n=r);var o=n.split("-");return e.format(o[0].trim())+" - "+t.format(o[1].trim())}function i(e,t){return e.year()==t.year()&&e.month()==t.month()&&e.date()==t.date()}function o(e,t){return e&&e.isValid()?(0==e.hour()&&0==e.minute()&&(e.hour(t.hour()),e.minute(t.minute())),e):t?t.clone():null}function a(e,t){return o(moment(e||null),moment(t||null))}function s(e,t,n){for(var r=0,i=new Date(n.getFullYear(),n.getMonth(),1);;){if(i.getDay()===e&&++r==t)break;i.setDate(i.getDate()+1)}return i}function c(e,t){return null==e&&(e=""),e[0]==t?e:t+e}function l(e,t){if(void 0===t&&(t="top"),e="string"==typeof e?$(e):e,0==e.length)return null;var n=e.offset().top;return"middle"==t?n-($(window).height()-e.outerHeight())/2:Math.max(n,0)}function u(t,n){if(!t)return null;n||(n="name");var r=t[n+"_"+e.$cfg.lang];return void 0===r&&(r=t[n]),r}function p(e){for(var t=e;t&&!t.hasClass("page");)t=t.parent();return t.hasClass("page")?t.data("page"):null}function d(t){t=t.replace("#/","").replace("#","");var n={hash:"#/"+t},r=t.split("?"),i=(r[0]||"").split("/");return n.page=i[0],"cmd"==n.page||e.$pages.exists(n.page)?n.dest=i[i.length-1]:(n.dest=n.page,n.page="main"),n.args=f(r[1]),n}function f(e){if(!e)return{};var t={};return $q(e.split("&")).ForEach(function(e){var n=e.split("=");t[decodeURIComponent(n[0])]=decodeURIComponent(n[1])}),t}function h(e){var t=0,n=0,r=0;return e.replace(/\*\*/g,function(e,n){return++t%2==1?"<b>":"</b>"}).replace(/\*/g,function(e,t){return++n%2==1?"<strong>":"</strong>"}).replace(/_/g,function(e,t){return++r%2==1?"<i>":"</i>"})}function g(e,t){return"]"===t&&(t="\\]"),"\\"===t&&(t="\\\\"),e.replace(new RegExp("^["+t+"]+|["+t+"]+$","g"),"")}function m(e,t){return"]"===t&&(t="\\]"),"\\"===t&&(t="\\\\"),e.replace(new RegExp("^["+t+"]","g"),"")}function v(e,t){for(var n=t.split("."),r=0;r<n.length;r++)e=e[n[r]];return e}t.formatDate=n,t.formatFromTo=r,t.dateEquals=i,t.mergeDates=o,t.mergeDatesStr=a,t.nthWeekdayOfMonth=s,t.ensureStartsWith=c,t.getOffset=l,t.localize=u,t.getPage=p,t.parseUrl=d,t.splitArgs=f,t.formatMd=h,t.trim=g,t.trimStart=m,t.expandPath=v,String.prototype.format=function(){var e=this,t=arguments;if(!t||!t.length)return e;1==t.length&&"object"==typeof t[0]&&(t=t[0]);for(var n in t)e=e.replace("{"+n+"}",t[n]);return e}}(e.$util||(e.$util={}))}($oewr||($oewr={}));var $oewr;!function(e){!function(t){function n(t){$.extend(this,t),e.$res=t.res,r(),i()}function r(){$q(e.MTBEventTypes).ForEach(function(t){return $.extend(t.Value,e.$res.eventTypes[t.Key])}),moment.locale(t.lang)}function i(){$q(t.pages).ForEach(function(e){$q(e.Value.synonyms).ForEach(function(n){t.pages[n]={name:n,preload:!1,synonyms:[],synname:e.Key}})})}t.init=n}(e.$cfg||(e.$cfg={}))}($oewr||($oewr={}));var $oewr;!function(e){e.MTBEventTypes={},e.MTBEventTypes[0]=e.MTBEventTypes.None={id:0,name:"None",description:"@@cfg",icon:"@@cfg",duration:0},e.MTBEventTypes[1]=e.MTBEventTypes.TechniqueTraining={id:1,name:"TechniqueTraining",description:"@@cfg",icon:"@@cfg",duration:3.5},e.MTBEventTypes[2]=e.MTBEventTypes.GuidedTour={id:2,name:"GuidedTour",description:"@@cfg",icon:"@@cfg",duration:4},e.MTBEventTypes[3]=e.MTBEventTypes.EBikeTour={id:3,name:"EBikeTour",description:"@@cfg",icon:"@@cfg",duration:4},e.MTBEventTypes[4]=e.MTBEventTypes.Camp={id:4,name:"Camp",description:"@@cfg",icon:"@@cfg",duration:72},e.MTBEventTypes[5]=e.MTBEventTypes.MechanicalTraining={id:5,name:"MechanicalTraining",description:"@@cfg",icon:"@@cfg",duration:2}}($oewr||($oewr={}));var $oewr;!function(e){!function(e){e[e.TakesPlace=0]="TakesPlace",e[e.InProgress=1]="InProgress",e[e.Canceled=2]="Canceled",e[e.Deleted=3]="Deleted"}(e.MTBEventStatus||(e.MTBEventStatus={}));var t;!function(e){e[e.NoOne=0]="NoOne",e[e.Admins=1]="Admins",e[e.Partner=3]="Partner",e[e.Everyone=7]="Everyone"}(t=e.MTBEventRegType||(e.MTBEventRegType={}));var n=function(){function n(e){this.state=e}return n.prototype.get=function(t,n){switch(n){case"date":var r=e.$util.mergeDatesStr(this.state[t],this.p(t));return r.isValid()||(r=null),r;case"localize":return e.$util.localize(this.state,t)||e.$util.localize(this.p(),t);default:return null!=this.state[t]?this.state[t]:this.p(t)}},n.prototype.p=function(e){var t=this.parent();return t&&t.state?e?t.state[e]:t.state:null},n.prototype.eventId=function(){return this.state.eventId},n.prototype.parentId=function(){return this.state.parentId},n.prototype.parent=function(){return e.$data.eventMap.Get(this.state.parentId)},n.prototype.seriesId=function(){return this.parentId()||this.eventId()},n.prototype.series=function(){return e.$data.eventMap.Get(this.seriesId())||this},n.prototype.isSeries=function(){return this.seriesId()==this.eventId()},n.prototype.from=function(){return this.get("from","date")},n.prototype.to=function(){return this.get("to","date")},n.prototype.typeId=function(){return this.get("type")},n.prototype.type=function(){return e.MTBEventTypes[this.typeId()]},n.prototype.status=function(){return this.get("status")},n.prototype.name=function(){return this.get("name","localize")},n.prototype.name_de=function(){return this.get("name")},n.prototype.name_en=function(){return this.get("name_en")},n.prototype.shortDescription=function(){return this.get("shortDescription","localize")},n.prototype.shortDescription_de=function(){return this.get("shortDescription")},n.prototype.shortDescription_en=function(){return this.get("shortDescription_en")},n.prototype.description=function(){return this.get("description","localize")},n.prototype.description_de=function(){return this.get("description")},n.prototype.description_en=function(){return this.get("description_en")},n.prototype.requirements=function(){return this.get("requirements","localize")},n.prototype.requirements_de=function(){return this.get("requirements")},n.prototype.requirements_en=function(){return this.get("requirements_en")},n.prototype.price=function(){return this.get("price")},n.prototype.priceText=function(){return this.isErlebniscard()?e.$res.events.erlebniscardPrice:this.priceAsNr()+" EUR"},n.prototype.priceAsNr=function(){return parseFloat(this.price())},n.prototype.isErlebniscard=function(){return this.price()===n.ErlebniscardPrice},n.prototype.level=function(){return this.get("level")},n.prototype.levelName=function(){return e.MTBLevel[this.level()]},n.prototype.levelDescription=function(){return e.$res.level[this.levelName()]},n.prototype.img=function(t){void 0===t&&(t=!0);var n=this.get("img");return n?"data:"==n.substr(0,5)?n:t?e.$cfg.root+e.$res.events.imgPath+n:n:null},n.prototype.meetingPoint=function(){return this.get("meeting")||n.DefaultMeetingPoint},n.prototype.lat=function(){return parseFloat(this.meetingPoint().split("/")[0])||46.56681976613046},n.prototype.lng=function(){return parseFloat(this.meetingPoint().split("/")[1])||13.920010328292847},n.prototype.meetingPointDescription=function(){return this.meetingPoint().split("/")[2]||"Parkplatz Natur Aktiv Park, Faak am See"},n.prototype.maxParticipants=function(){return this.get("max_participants")||0},n.prototype.allowReg=function(){return this.get("allow_reg")||0},n.prototype.isRegAllowed=function(){if(!e.$cfg.allow_reg)return!1;switch(this.allowReg()){case t.Admins:return e.$ctx.session.isAdmin();case t.Partner:return e.$ctx.session.isPartner()||e.$ctx.session.isAdmin();case t.Everyone:return!0}return!1},n.prototype.occurrences=function(){var t=this.seriesId();return $q(e.$data.events).Where(function(e){return e.seriesId()==t&&e.isOccurrence()}).ToArray()},n.prototype.isOccurrence=function(){return null!=this.from()&&null!=this.to()},n.ErlebniscardPrice="Erlebniscard",n.DefaultMeetingPoint="46.56681976613046/13.920010328292847/Parkplatz Natur Aktiv Park, Faak am See",n}();e.MTBEvent=n}($oewr||($oewr={}));var $oewr;!function(e){!function(e){e[e.Canceled=0]="Canceled",e[e.Active=1]="Active"}(e.MTBRegistrationStatus||(e.MTBRegistrationStatus={}))}($oewr||($oewr={}));var $oewr;!function(e){!function(t){function n(){return e.$doc.hasClass("no-data")?(t.waitEvents=$.Deferred().resolve().promise(),$.Deferred().resolve().promise()):$.when((t.waitEvents=e.$ctx.db.event.q().orderBy("from asc").find()).then(function(e){t.events=e,i()}))}function r(t){t?e.$doc.bind("data-change",t):e.$doc.trigger("data-change")}function i(){t.eventMap=$q(t.events).ToDictionary(function(e){return e.state.eventId},function(e){return e})}function o(e){Array.isArray(e)||(e=[e]),t.events=$q(t.events).Concat(e).OrderBy(function(e){return e.from()}).ToArray(),i(),r()}function a(e){var n=Array.isArray(e)?e:[e];t.events=$q(t.events).Where(function(e){return!$q(n).Any(function(t){return t.eventId()==e.eventId()})}).ToArray(),i(),r()}t.init=n,t.change=r,t.addEvent=o,t.deleteEvent=a}(e.$data||(e.$data={}))}($oewr||($oewr={}));var $oewr;!function(e){!function(t){!function(t){function n(){o||(s++,e.$body.addClass("is-loading"),o=setTimeout(function(){c.addClass("show")},a))}function r(){(s=Math.max(0,s-1))>0||(o&&(clearTimeout(o),o=null),c.removeClass("show"),e.$body.removeClass("is-loading"))}function i(e){void 0==e&&(e=!c.hasClass("show")),e?n():r()}var o,a=300,s=0,c=$("#loader");t.show=n,t.hide=r,t.toggle=i}(t.loader||(t.loader={}))}(e.$ui||(e.$ui={}))}($oewr||($oewr={}));var $oewr;!function(e){!function(t){!function(n){function r(n,r){var i=(n?e.$util.getPage(n):null)||e.$pages.get("main"),o=[],a=t.scrollex.init($((n?"":".page ")+"> section, section > section",n),{enter:r&&r.setHashOnScroll?function(t,n){if(e.$body.hasClass("is-loading"))return!1;var r=n.attr("href");r&&(-1==o.indexOf(r)&&o.push(r),1==o.length&&e.$app.setHash(o[0]))}:null,leave:r&&r.setHashOnScroll?function(t,n){if(e.$body.hasClass("is-loading"))return!1;var r=n.attr("href");if(r){var i=o.indexOf(r);i>-1&&(o.splice(i,1),1==o.length&&e.$app.setHash(o[0]))}}:null});i.pageCnt.on("pageload",function(){a.options.enabled=!0}),i.pageCnt.on("pagehide",function(){a.options.enabled=!1})}n.init=r}(t.section||(t.section={}))}(e.$ui||(e.$ui={}))}($oewr||($oewr={}));var $oewr;!function(e){!function(t){!function(t){function n(e){$("a",e).each(function(){r($(this))})}function r(t){var n=t.attr("href");n?"#"==n[0]&&t.off("click.href").on("click.href",function(n){n&&n.preventDefault();var r=t.attr("href");r&&(r=r.format(e.$url.args)),e.$app.hashChange(r,t.attr("anchor"),t.attr("speed"))}):t.off("click.href").on("click.href",function(e){return e.preventDefault(),!1})}t.init=n}(t.link||(t.link={}))}(e.$ui||(e.$ui={}))}($oewr||($oewr={}));var $oewr;!function(e){!function(e){!function(e){function t(e){Modernizr.svgasimg||$("img.svg",e).each(function(e,t){var r=$(t);r.hasClass("svg")&&n(r)})}function n(e){var t=e.attr("src");e.attr("src",t.replace(".svg",".png"))}e.init=t}(e.img||(e.img={}))}(e.$ui||(e.$ui={}))}($oewr||($oewr={}));var $oewr;!function(e){!function(e){!function(t){function n(t){e.scrollex.init($(".items",t),{delay:r}).context.children().wrapInner('<div class="inner"></div>')}var r;t.init=n}(e.items||(e.items={}))}(e.$ui||(e.$ui={}))}($oewr||($oewr={}));var $oewr;!function(e){!function(t){!function(t){function n(t){e.$data.waitEvents.done(function(){$(".event-table table",t).each(function(e,t){r($(t))})})}function r(t){var n=moment(new Date);$("tr.dummy",t).remove(),t.prepend($q(e.$data.events).Where(function(t){return t.isOccurrence()&&t.status()==e.MTBEventStatus.TakesPlace}).SkipWhile(function(e){return e.from()<n}).Take(e.$cfg.shownEvents).Select(function(e){return i(e)}).ToArray())}function i(t){var n=e.$res.events.eventUrl.format(t.eventId());return $("<tr>").addClass("event").append($("<td>").text(t.from().format(e.$res.news.dateFormat))).append($("<td>").append($("<a>").attr("href",n).text(t.name()))).append($("<td>").text(t.priceText()))}t.init=n}(t.events||(t.events={}))}(e.$ui||(e.$ui={}))}($oewr||($oewr={}));var $oewr;!function(e){!function(t){!function(n){function r(e){t.scrollex.init($(".gallery",e).wrapInner('<div class="inner"></div>').prepend(skel.vars.mobile?"":'<div class="forward"></div><div class="backward"></div>'),{delay:50}).context.children(".inner").css("overflow-y",skel.vars.mobile?"visible":"hidden").css("overflow-x",skel.vars.mobile?"scroll":"hidden").scrollLeft(0),i(e)}function i(t){$(".gallery.lightbox",t).on("click","a",function(t){var n=$(this),r=n.parents(".gallery"),i=r.children(".modal"),o=i.find("img"),a=n.attr("href");a&&a.match(/\.(jpg|gif|png|mp4)$/)&&(t.preventDefault(),t.stopPropagation(),i[0]._locked||(i[0]._locked=!0,i.data("cur",n),o.attr("src",a),i.addClass("visible"),i.focus(),e.$main.addClass("no-scroll"),setTimeout(function(){i[0]._locked=!1},300)))}).on("click",".modal",function(t){var n=$(this),r=n.find("img");n[0]._locked||n.hasClass("visible")&&(n[0]._locked=!0,n.removeClass("loaded"),setTimeout(function(){n.removeClass("visible"),e.$main.removeClass("no-scroll"),setTimeout(function(){r.attr("src",""),n[0]._locked=!1,n.removeData("cur"),e.$body.focus()},175)},125))}).on("click",".prev",function(e){var t=$(this).parents(".gallery").children(".modal"),n=t.data("cur");if(n){var r=n.parent().prev().find("a");r&&r.length||(r=n.parent().parent().children().last().find("a")),r&&r.length&&r.trigger("click")}}).on("click",".next",function(e){var t=$(this).parents(".gallery").children(".modal"),n=t.data("cur");if(n){var r=n.parent().next().find("a");r&&r.length||(r=n.parent().parent().children().first().find("a")),r&&r.length&&r.trigger("click")}}).on("keydown",".modal",function(e){var t=$(this);switch(e.keyCode){case 27:t.trigger("click");break;case 37:t.parent().find(".prev").trigger("click");break;case 39:t.parent().find(".next").trigger("click")}}).prepend('<div class="modal" tabIndex="-1"><a class="prev icon style2 fa-angle-left"></a><div class="inner"><img src="" /></div><a class="next icon style2 fa-angle-right"></a></div>').find("img").on("load",function(e){var t=$(this),n=t.parents(".modal");setTimeout(function(){n.hasClass("visible")&&n.addClass("loaded")},275)})}n.init=r}(t.gallery||(t.gallery={}))}(e.$ui||(e.$ui={}))}($oewr||($oewr={}));var $oewr;!function(e){!function(e){!function(t){function n(e){$(".map",e).q().ForEach(function(e){return t.maps.push(r(e))})}function r(e){var t={element:e,wait:$.Deferred()},n=parseFloat(e.attr("lat")),r=parseFloat(e.attr("lng")),l=parseFloat(e.attr("zoom"));return n&&r&&(t.start={lat:n,lng:r}),l&&(t.zoom=l),t.element.data("gmap_promise",t.wait.promise()),t.marker=$q($(".marker",e)).Select(function(e){return{position:{lat:parseFloat(e.attr("lat")),lng:parseFloat(e.attr("lng"))},title:e.attr("title"),label:e.attr("label"),draggable:e.hasClass("draggable")}}).ToArray(),t.paths=$q($(".path",e)).Select(function(e){return{path:$q(e.children()).Select(function(e){return{lat:parseFloat(e.attr("lat")),lng:parseFloat(e.attr("lng"))}}).ToArray(),geodesic:!0,strokeColor:e.attr("color"),strokeOpacity:1|parseFloat(e.attr("opacity")),strokeWeight:2|parseFloat(e.attr("weight"))}}).ToArray(),window["initMap"+s]=function(){i(t,s)},o?c.done(function(){i(t,s)}):(e.after('<script async defer src="https://maps.googleapis.com/maps/api/js?key='+a+"&callback=initMap"+s+'"><\/script>'),o=!0),s++,t}function i(t,n){c.resolve();var r=new google.maps.Map(t.element[0],{center:t.start?{lat:t.start.lat,lng:t.start.lng}:null,zoom:t.zoom,styles:e.mapStyle});t.element.data("gmap",r);var i=[];$q(t.marker).ForEach(function(e,n){var o=new google.maps.Marker({position:new google.maps.LatLng(e.position.lat,e.position.lng),title:e.title,label:e.label,draggable:e.draggable});o.setMap(r),i.push(o),t.element.attr("m"+n+"_lat",e.position.lat),t.element.attr("m"+n+"_lng",e.position.lng),e.draggable&&o.addListener("drag",function(){var e=o.getPosition();t.element.attr("m"+n+"_lat",e.lat),t.element.attr("m"+n+"_lng",e.lng)})}),t.element.data("gmap_markers",i);var o=[];$q(t.paths).ForEach(function(e){var t=new google.maps.Polyline(e);o.push(t),t.setMap(r)}),t.element.data("gmap_paths",o);var a;t.element.mouseenter(function(){a||(a=t.element.children().first(),a.mouseleave(function(){a.addClass("no-pointer-events")})),a.addClass("no-pointer-events")}),t.element.click(function(){a.removeClass("no-pointer-events")}),t.wait.resolve()}var o,a="AIzaSyBdO_cpM267sMdq2GO-ujjfch3dMjUHMjY",s=0,c=$.Deferred();t.maps=[],t.init=n}(e.map||(e.map={}))}(e.$ui||(e.$ui={}))}($oewr||($oewr={}));var $oewr;!function(e){!function(e){e.mapStyle=[{stylers:[{saturation:-100},{gamma:1}]},{elementType:"labels.text.stroke",stylers:[{visibility:"off"}]},{featureType:"poi.business",elementType:"labels.text",stylers:[{visibility:"off"}]},{featureType:"poi.business",elementType:"labels.icon",stylers:[{visibility:"off"}]},{featureType:"poi.place_of_worship",elementType:"labels.text",stylers:[{visibility:"off"}]},{featureType:"poi.place_of_worship",elementType:"labels.icon",stylers:[{visibility:"off"}]},{featureType:"road",elementType:"geometry",stylers:[{visibility:"simplified"}]},{featureType:"water",stylers:[{visibility:"on"},{saturation:50},{gamma:0},{hue:"#50a5d1"}]},{featureType:"administrative.neighborhood",elementType:"labels.text.fill",stylers:[{color:"#333333"}]},{featureType:"road.local",elementType:"labels.text",stylers:[{weight:.5},{color:"#333333"}]},{featureType:"transit.station",elementType:"labels.icon",stylers:[{gamma:1},{saturation:50}]}]}(e.$ui||(e.$ui={}))}($oewr||($oewr={}));var $oewr;!function(e){!function(t){!function(n){function r(){t.link.init(s),a.click(function(){e.$main.hasClass("menu-opened")?o():i()}),s.click(function(e){var t=$(e.target);("menu"==t.attr("id")||t.hasClass("icon"))&&o()})}function i(){a.addClass("fa-close").removeClass("fa-bars"),e.$main.addClass("menu-opened").addClass("no-scroll"),s.addClass("opened")}function o(){a.addClass("fa-bars").removeClass("fa-close"),e.$main.removeClass("menu-opened").removeClass("no-scroll"),s.removeClass("opened")}var a=$("#menu-btn"),s=$("#menu");n.init=r,n.open=i,n.close=o}(t.menu||(t.menu={}))}(e.$ui||(e.$ui={}))}($oewr||($oewr={}));var $oewr;!function(e){!function(t){$.fn.timeline=function(){return this.data("timeline")};!function(e){function t(e){$(".timeline",e).each(function(e,t){new n($(t))})}e.init=t}(t.timeline||(t.timeline={}));var n=function(){function n(n){this.element=n.data("timeline",this),this.page=e.$util.getPage(this.element),this.initBlocks(),this.initScrolling(),t.link.init(n)}return n.prototype.initScrolling=function(){var t=this;this.hideBlocks(),e.$window.on("scroll",function(){t&&t.hasBlocks()&&t.pageIsActive()&&(window.requestAnimationFrame?window.requestAnimationFrame(function(){t.showBlocks()}):setTimeout(function(){t.showBlocks()},100))})},n.prototype.hasBlocks=function(){return this.blocks&&this.blocks.length>0},n.prototype.pageIsActive=function(){return this.page&&this.page.pageCnt.hasClass("current")},n.prototype.initBlocks=function(){this.blocks=$(".timeline-block",this.element)},n.prototype.hideBlocks=function(){var e=this;this.blocks.each(function(t,n){e.hideBlock($(n))})},n.prototype.showBlocks=function(){var e=this;this.blocks.each(function(t,n){e.showBlock($(n))})},n.prototype.refreshBlocks=function(){var e=this;this.blocks.each(function(t,n){var r=$(n);e.hideBlock(r),e.showBlock(r)})},n.prototype.hideBlock=function(t){t.offset().top>e.$window.scrollTop()+e.$window.height()*n.offset&&t.find(".timeline-img, .timeline-content").addClass("is-hidden")},n.prototype.showBlock=function(t){t.offset().top<=e.$window.scrollTop()+e.$window.height()*n.offset&&t.find(".timeline-img").hasClass("is-hidden")&&t.find(".timeline-img, .timeline-content").removeClass("is-hidden").addClass("bounce-in")},n.offset=.8,n}();t.Timeline=n}(e.$ui||(e.$ui={}))}($oewr||($oewr={}));var $oewr;!function(e){!function(e){!function(e){function t(e,t){return new n(e,t)}e.init=t;var n=function(){function e(t,n){var r=this;this.context=t,this.context.each(function(e,t){$(t).data("scrollex",r)});var i=this,o=n.initialize,a=n.terminate,s=n.enter,c=n.leave;this.options=n=$.extend({},e.defaultOptions,n,{initialize:function(){i.initialize($(this),o)},terminate:function(){i.terminate($(this),a)},enter:function(){i.enter($(this),s)},leave:function(){i.leave($(this),c)}}),this.context.scrollex(n)}return e.prototype.initialize=function(e,t){!this.options.enabled||t&&!1===t(this,e)||e.addClass(this.options.inactiveClass)},e.prototype.terminate=function(e,t){!this.options.enabled||t&&!1===t(this,e)||e.removeClass(this.options.inactiveClass)},e.prototype.enter=function(e,t){!this.options.enabled||t&&!1===t(this,e)||e.removeClass(this.options.inactiveClass)},e.prototype.leave=function(e,t){if(this.options.enabled&&(!t||!1!==t(this,e))){var n=this.options;(1==n.bidirectional||n.bidirectional&&e.hasClass(n.bidirectional))&&e.addClass(n.inactiveClass)}},e.defaultOptions={enabled:!0,top:"30vh",bottom:"30vh",inactiveClass:"is-inactive",bidirectional:"onscroll-bidirectional"},e}();e.Scrollex=n}(e.scrollex||(e.scrollex={}))}(e.$ui||(e.$ui={}))}($oewr||($oewr={}));var $oewr;!function(e){!function(t){function n(e,n){p(e),t.section.init(e,n),t.img.init(e),t.items.init(e),t.events.init(e),t.gallery.init(e),t.timeline.init(e),t.map.init(e),t.link.init(e),t.$scrollCnt.trigger("scroll")}function r(){u(),c(),l(),t.menu.init()}function i(){skel.breakpoints({xlarge:"(max-width: 1680px)",large:"(max-width: 1280px)",medium:"(max-width: 980px)",small:"(max-width: 736px)",xsmall:"(max-width: 480px)",xxsmall:"(max-width: 360px)",minxlarge:"(min-width: 1680px)",minlarge:"(min-width: 1280px)",minmedium:"(min-width: 980px)",minsmall:"(min-width: 736px)",minxsmall:"(min-width: 480px)",minxxsmall:"(min-width: 360px)"})}function o(t,n,r,i,o){o||(o=$.Deferred());var s=t.page||"main";return e.$pages.exists(s+"-"+t.dest)&&(s+="-"+t.dest),e.$pages.load(s).done(function(e){var s=t.dest?$("#"+t.dest):null;s&&!s.length&&(s=$("section[href='#/"+t.dest+"']")),a(e,s,n,r,i,o)}).fail(function(e){o.reject(e)}),o.promise()}function a(t,n,r,i,o,a){void 0===r&&(r="top"),void 0===i&&(i="normal"),n&&n.length||(n=t.pageCnt),r||(r=n.attr("anchor")||"top"),i||(i=n.attr("speed")||"normal");var c;return o&&(c=t.remOffset()),void 0==c&&(c=e.$util.getOffset(n,r)),s(c,r,i,a)}function s(e,n,r,i){if(void 0===n&&(n="top"),void 0===r&&(r="normal"),i||(i=$.Deferred()),"immediate"==r)t.$scrollCnt.stop().scrollTop(e),setTimeout(function(){i.resolve()},100);else{var o=1e3;"slow"==r?o=2e3:"fast"==r&&(o=300),t.$scrollCnt.stop().animate({scrollTop:e},o,"swing",function(){i.resolve()})}return i.promise()}function c(){t.$backBtn.click(function(t){t&&t.preventDefault(),e.$app.back()})}function l(){var t=$("#lang-btn"),n=function(n){var r=e.$window.height(),i=e.$window.scrollTop();t.toggleClass("hidden",i>r/2||e.$pages.current&&e.$pages.current.pageCnt.hasClass("no-lang-btn"))};e.$window.scroll(n),e.$window.resize(n),n()}function u(){if("ie"==skel.vars.browser){var t;e.$window.on("resize.flexbox-fix",function(){var n=$(".fullscreen");clearTimeout(t),t=setTimeout(function(){n.prop("scrollHeight")>e.$window.height()?n.css("height","auto"):n.css("height","100vh")},250)}).triggerHandler("resize.flexbox-fix")}}function p(e){skel.canUse("object-fit")||$(".banner .image, .spotlight .image",e).each(function(e,t){var n=$(t),r=n.children("img"),i=n.parent().attr("class").match(/image-position-([a-z]+)/);switch(n.css("background-image",'url("'+r.attr("src")+'")').css("background-repeat","no-repeat").css("background-size","cover"),i.length>1?i[1]:""){case"left":n.css("background-position","left");break;case"right":n.css("background-position","right");break;case"center":default:n.css("background-position","center")}r.css("opacity","0")})}t.$scrollCnt=$("body,html"),t.$backBtn=$("#back-btn"),t.init=n,t.initCommon=r,t.initSkel=i,t.scrollTo=o,t.scrollToPage=a,t.scrollToPos=s}(e.$ui||(e.$ui={}))}($oewr||($oewr={}));var $oewr;!function(e){!function(t){!function(n){var r=function(){function n(e,t,n,r,i){this.name=e,this.id=t,this.parse=n,this.staticRes=r,this.failLoadStatic=i}return n.prototype.q=function(){return new i(this)},n.prototype.set=function(n,r){var i=this,o=Array.isArray(r)?r:[r];return"post"==n&&this.id&&$q(o).ForEach(function(e){return delete e[i.id]}),t[n]("/"+e.$cfg.ctx.db+"/_table/"+this.name,{resource:o}).then(function(e){return e&&e.resource&&e.resource.length&&$q(e.resource).ForEach(function(e,t){return $.extend(o[t],e)}),Array.isArray(r)?$q(r).Select(function(e){return i.parse(e)}).ToArray():i.parse(r)})},n.prototype.insert=function(e){return this.set("post",e)},n.prototype.update=function(e){return this.set("put",e)},n.prototype.delete=function(e){return this.set("del",e)},n}();n.DBTable=r;var i=function(){function n(t){this._table=t,this._url="/"+e.$cfg.ctx.db+"/_table/"+t.name}return n.prototype.select=function(e){return this._select=e,this},n.prototype.where=function(e){return this._where=e,this},n.prototype.related=function(e){return this._related=e,this},n.prototype.orderBy=function(e){return this._orderBy=e,this},n.prototype.groupBy=function(e){return this._groupBy=e,this},n.prototype.limit=function(e){return this._limit=e,this},n.prototype.offset=function(e){return this._offset=e,this},n.prototype.parseSingle=function(e){return e?this._table.parse?this._table.parse(e):e:null},n.prototype.parseMany=function(e){var t=this;return e&&e.resource?this._table.parse?$q(e.resource).Select(function(e){return t._table.parse(e)}).ToArray():e.resource:[]},n.prototype.get=function(e){var n=this,r={};return this._select&&(r.fields=this._select),t.get(this._url+"/"+e,r).then(function(e){return n.parseSingle(e)})},n.prototype.find=function(){var e=this,n={};return this._select&&(n.fields=this._select),this._where&&(n.filter=this._where),this._orderBy&&(n.order=this._orderBy),this._groupBy&&(n.group=this._groupBy),this._limit&&(n.limit=this._limit),this._offset&&(n.offset=this._offset),this._related&&(n.related=this._related),t.get(this._url,n).then(function(t){return e.parseMany(t)},function(){if(e._table.staticRes)return console.debug("Failed to load "+e._table.name+" from service, try using static resource."),e._table.failLoadStatic&&e._table.failLoadStatic(),e.retryStatic(e._table.staticRes).then(function(t){return e.parseMany(t)})})},n.prototype.retryStatic=function(t){return $.ajax({type:"GET",url:e.$cfg.root+t,accepts:{json:"application/json"},contentType:"application/json"})},n}();n.DBQuery=i,n.event=new r("event","eventId",function(t){return new e.MTBEvent(t)},"data/events.json",function(){e.$cfg.allow_reg=!1})}(t.db||(t.db={}))}(e.$ctx||(e.$ctx={}))}($oewr||($oewr={}));var $oewr;!function(e){!function(t){var n;!function(r){function i(){return(r.current?r.current.session_token:null)||Cookies.get(w)}function o(){return C.promise()}function a(e,r,i){void 0===i&&(i=0),C||(C=$.Deferred());var o={email:e,password:r};return i?o.duration=i:o.remember_me=!0,console.debug("sign in "+JSON.stringify(o)),t.post("/user/session",o).always(function(){C&&C.resolve()}).then(function(e){return u(e),t.get("/user/profile")}).then(function(e){return n.profile=e,n.current}).fail(function(e,t,n){return u(null)})}function s(e){return C||(C=$.Deferred()),t.post("/hashauth",{hash:e}).always(function(){C&&C.resolve()}).then(function(e){return u(e),t.get("/user/profile")}).then(function(e){return n.profile=e,n.current}).fail(function(e,t,n){return u(null)})}function c(){return C||(C=$.Deferred()),r.current&&r.current.session_token?(console.debug("sign out"),t.del("/user/session").always(function(){C&&C.resolve()}).then(function(){return u(null)})):(C&&C.resolve(),$.Deferred().resolve().promise())}function l(){C||(C=$.Deferred());var e=r.current?r.current.session_token:null;return e||(e=Cookies.get(w)),console.debug("refresh session "+e),e?t.put("/user/session").always(function(){C&&C.resolve()}).then(function(e){return u(e),console.debug("session refreshed "+e.session_token),t.get("/user/profile")}).then(function(e){return n.profile=e,console.debug("got profile for session"),n.current}).fail(function(e,t,n){return u(null)}):(C&&C.resolve(),$.Deferred().reject().promise())}function u(e){return console.debug("set session "+JSON.stringify(e)),r.current=e,r.current?Cookies.set(w,r.current.session_token,{expires:1}):(Cookies.remove(w),r.profile=null),y(),r.current}function p(){var t=(r.current?r.current.role:"")||"";return e.$cfg.roles[t]}function d(t){for(var n=t.split("/").reverse(),r=e.$cfg.access;r&&n.length;)r=r[n.pop()];return!r||($q(r).Contains(p())||$q(r).Contains("*"))}function f(){return null==r.current||null==r.current.role||"OEWR WWW"==r.current.role}function h(){return null!=r.current&&"OEWR Partner"==r.current.role}function g(){return null!=r.current&&"OEWR Admin"==r.current.role}function m(){return null!=Cookies.get(b)}function v(){Cookies.set(b,"true",{expires:365})}function y(t){t?e.$doc.bind("session-change",t):e.$doc.trigger("session-change")}var w="alpbros_session",b="alpbros_cookie_agreement";r.current=null,r.profile=null;var C=$.Deferred().resolve();r.token=i,r.wait=o,r.signin=a,r.hashauth=s,r.signout=c,r.refresh=l,r.granted=d,r.isPublic=f,r.isPartner=h,r.isAdmin=g,r.hasCookieAgreement=m,r.agreeCookies=v,r.change=y}(n=t.session||(t.session={}))}(e.$ctx||(e.$ctx={}))}($oewr||($oewr={}));var $oewr;!function(e){!function(t){function n(n){return t.get("/registration/"+n+"?db="+e.$cfg.ctx.db).then(function(e){return e||(e={}),{registrations:e.registrations,count:e.count||0}})}function r(n,r,i){return t.post("/registration?lang="+e.$cfg.lang+"&db="+e.$cfg.ctx.db,{token:r,reg:n,email:i})}function i(n,r,i,o){return t.del("/registration?lang="+e.$cfg.lang+"&db="+e.$cfg.ctx.db,{reg:n,force:r,status:i||e.MTBRegistrationStatus.Canceled,email:o})}t.getRegistrations=n,t.register=r,t.deleteRegistration=i}(e.$ctx||(e.$ctx={}))}($oewr||($oewr={}));var $oewr;!function(e){!function(t){function n(n,r,i){return t.session.wait().then(function(){return i&&"GET"!=n&&(i=JSON.stringify(i)),$.ajax({type:n,url:e.$cfg.ctx.baseurl+r,data:i||{},accepts:{json:"application/json"},contentType:"application/json",headers:{"X-DreamFactory-API-Key":e.$cfg.ctx.apikey,"X-DreamFactory-Session-Token":t.session.token()}})})}function r(e,t){return n("GET",e,t)}function i(e,t){return n("POST",e,t)}function o(e,t){return n("PUT",e,t)}function a(e,t){return n("DELETE",e,t)}t.call=n,t.get=r,t.post=i,t.put=o,t.del=a}(e.$ctx||(e.$ctx={}))}($oewr||($oewr={}));var $oewr;!function(e){!function(t){var n=function(){function t(t,n,r){this.name=t,this.pageCnt=n,this.pageCnt.data("page",this),this.pageCnt.hasClass("init-ui")&&(e.$ui.init(this.pageCnt),this.pageCnt.removeClass("init-ui"))}return t.prototype.isCurrent=function(){return this.pageCnt.hasClass("current")},t.prototype.isHidden=function(){return this.pageCnt.hasClass("hidden")},t.prototype.defaultBack=function(){return this.pageCnt.attr("back")},t.prototype.remOffset=function(e){if(null===e)this.pageCnt.removeAttr("offset");else{if(void 0===e){var t=this.pageCnt.attr("offset");return null!=t?parseInt(t):null}this.pageCnt.attr("offset",e)}},t.prototype.load=function(e,t){e&&e.resolve(this)},t}();t.Page=n}(e.$pages||(e.$pages={}))}($oewr||($oewr={}));var $oewr;!function(e){!function(t){var n=function(t){function n(n,r,i){var o=t.call(this,n,r,i)||this;return e.$ui.initCommon(),e.$ui.init(r,{setHashOnScroll:Modernizr.history}),i.resolve(o),o}return __extends(n,t),n}(t.Page);t.PageMain=n}(e.$pages||(e.$pages={}))}($oewr||($oewr={}));var $oewr
;!function(e){!function(t){var n=function(t){function n(n,r,i){var o=t.call(this,n,r,i)||this;return o.timelineCnt=$("#event-timeline"),e.$data.waitEvents.done(function(){o.initTimeline(!0),i.resolve(o)}).fail(function(){i.reject()}),e.$data.change(function(){o.initTimeline(!1)}),o}return __extends(n,t),n.prototype.load=function(e){this.timeline.hasBlocks()||this.timeline.initBlocks(),this.timeline.refreshBlocks(),e.resolve(this)},n.prototype.initForm=function(){var t=this;e.$ui.init($("form",this.pageCnt)),$("input#event-from-date",this.pageCnt).val((new Date).toISOString().substr(0,10));var n=$("select#event-type",this.pageCnt);$q(e.$res.eventTypes).ForEach(function(t){var r=e.MTBEventTypes[t.Key];n.append('<option value="'+r.id+'">'+r.description+"</option>")}),$("input,select",this.pageCnt).change(function(){return t.filterTimeline()})},n.prototype.initTimeline=function(t){this.appendEvents(),e.$ui.init(this.timelineCnt.parent()),t&&this.initForm(),this.timeline=this.timelineCnt.timeline(),this.filterTimeline()},n.prototype.appendEvents=function(){var t=this;this.timelineCnt.empty(),this.timelineItems=$q(e.$data.events).Where(function(t){return t.isOccurrence()&&(t.status()==e.MTBEventStatus.TakesPlace||e.$ctx.session.isAdmin())}).Select(function(e){return{event:e,item:t.getTimelineItem(e)}}).ToArray(),this.timelineCnt.append($q(this.timelineItems).Select(function(e,t){return e.item.toggleClass("even",t%2!=0)}).ToArray())},n.prototype.filterTimeline=function(){var t,n=(t=$("#event-from-date").val())?moment(t):null,r=(t=$("#event-to-date").val())?moment(t):null,i=$("#event-type").val(),o=e.MTBLevel.Everyone|($("#event-level-beginner").is(":checked")?e.MTBLevel.Beginner:e.MTBLevel.Everyone)|($("#event-level-advanced").is(":checked")?e.MTBLevel.Advanced:e.MTBLevel.Everyone),a=0;$q(this.timelineItems).ForEach(function(t){var s=t.event,c=n&&s.from()<n||r&&s.to()>r||i&&"all"!=i&&s.typeId()!=i||o<e.MTBLevel.All&&s.level()!=e.MTBLevel.Everyone&&0==(s.level()&o);t.item.toggleClass("hidden",c),c||(t.item.toggleClass("even",a%2!=0).toggleClass("first-child",0==a),a++)}),this.timeline.refreshBlocks()},n.prototype.getTimelineItem=function(t){var n=t.priceText(),r=e.$res.events.eventUrl.format(t.eventId()),i="#/cmd/edit-event?id="+t.eventId();return $('<div class="timeline-block" eventId="'+t.eventId()+'"><div class="timeline-img bg-color-'+this.getLevelColor(t)+'" title="'+t.type().name+'"><span class="icon style2 major '+t.type().icon+'"></span></div><div class="timeline-content"><h3>'+t.name()+'<br /><code><span class="icon fa-money"></span> '+n+'</code></h3><p><img src="'+t.img()+'" /><strong>'+e.$util.formatFromTo(t.from(),t.to(),e.$res.events.dateFormat,e.$res.events.multiDayFormat)+"<br />"+e.$res.events.level+": "+e.$res.level[e.MTBLevel[t.level()]]+"</strong><br /><br />"+t.shortDescription()+'</p><br style="clear: both;" /><a href="'+r+'" class="button special icon fa-pencil">'+e.$res.events.details+'</a> <a href="'+i+'" class="button icon fa-pencil role-admin">'+e.$res.events.edit+'</a><span class="date">'+e.$util.formatDate(t.from(),e.$res.events.fromFormat)+"</span></div></div>").data("event",t)},n.prototype.getLevelColor=function(t){switch(t.level()){case e.MTBLevel.Beginner:return"green";case e.MTBLevel.Advanced:return"orange";default:return"blue"}},n}(t.Page);t.PageEvents=n}(e.$pages||(e.$pages={}))}($oewr||($oewr={}));var $oewr;!function(e){!function(t){var n=function(t){function n(n,r,i){var o=t.call(this,n,r,i)||this;return e.$data.waitEvents.done(function(){e.$ui.init(r),$("#reg-submit").click(function(t){t.preventDefault();var n=o.validateReg();n&&(e.$ui.loader.show(),grecaptcha.reset(),o.recaptcha=$.Deferred(),o.recaptcha.done(function(e){o.submitReg(e,n)}),grecaptcha.execute())}),$(".map",o.pageCnt).data("gmap_promise").done(function(){o.mapMarker=$(".map",o.pageCnt).data("gmap_markers")[0],i.resolve(o)})}),o}return __extends(n,t),n.prototype.load=function(t){var n=this,r=parseInt(e.$url.args.id);if(!r)return void(t&&t.reject("Missing eventId and/or date!"));var i=this.event=e.$data.eventMap.Get(r);if(!i)return void(t&&t.reject("Event not found for '"+e.$url.hash+"'!"));e.$ctx.getRegistrations(r).done(function(e){n.registrations=e.registrations,n.regcount=e.count||0,n.initUI(i),t&&t.resolve(n)})},n.prototype.initUI=function(e){this.initDetails(e),this.initRegForm(e)},n.prototype.initDetails=function(t){var n=this,r=e.$res.event.details,i=function(e){return $(".event-"+e,n.pageCnt)};i("name").text(t.name()),i("description").text(t.description()),i("img").attr("src",t.img());var o=e.$util.formatFromTo(t.from(),t.to(),e.$res.event.details.dateFormat);i("date").html(r.date.format(o)),i("level").html(r.level.format(t.levelDescription()));var a=t.from().format(r.meetingTimeFormat);i("meeting").html(r.meeting.format(a,t.meetingPointDescription())),i("participants").html(r.participants.format(t.maxParticipants()));var s=t.isErlebniscard()?r.erlebniscardPrice:r.price.format(t.priceAsNr());i("price").html(s),this.mapMarker.setPosition(new google.maps.LatLng(t.lat(),t.lng())),this.pageCnt.toggleClass("erlebniscard",t.isErlebniscard()),this.pageCnt.toggleClass("allow-reg",t.isRegAllowed()),this.setRequirements(t)},n.prototype.setRequirements=function(t){var n=[],r=$q((t.requirements()||"").split("\n")).Select(function(e){return e.trim()}).ToArray(),i="!"!=r[0],o=$q(r).FirstOrDefault(null,function(e){return"*"!=e[0]})||e.$res.requirements[t.type().name].text,a=$q(r).Where(function(e){return"*"==e[0]}).ToArray();if(i)for(var s=0;;){var c=e.$res.requirements[t.type().name][s.toString()];if(!c)break;n.push(c),s++}else"!"==a[0]&&(a=$q(a).Skip(1).ToArray());n=n.concat(a),$(".event-requirements-text",this.pageCnt).html(e.$util.formatMd(o)),$(".event-requirements",this.pageCnt).empty().append($q(n).Select(function(t){return $("<li>"+e.$util.formatMd(e.$util.trimStart(t,"*").trim())+"</li>")}).ToArray())},n.prototype.initRegForm=function(t){var n=this,r=$("#reg-remaining",this.pageCnt),i=Math.max(0,t.maxParticipants()-this.regcount);if(r.text(i),this.pageCnt.toggleClass("regs-remaining",i>0),e.$ctx.session.isPartner()){var o=e.$ctx.session.profile;$("#reg-email",this.pageCnt).val(o.email),$("#reg-phone",this.pageCnt).val(o.phone),$("#reg-accommodation",this.pageCnt).val(o.name)}this.pageCnt.toggleClass("see-regs",null!=this.registrations),$("section.registrations table tbody",this.pageCnt).empty().append($q(this.registrations).Select(function(e,t){return n.getRegRow(e,t)}).ToArray())},n.prototype.getRegRow=function(t,n){var r=this,i=e.$res.event.details,o=e.$ctx.session.isAdmin()||e.$ctx.session.isPartner()&&t.createdBy===e.$ctx.session.current.email,a=n+1<=this.event.maxParticipants(),s=t.status==e.MTBRegistrationStatus.Active,c=s?e.MTBRegistrationStatus.Canceled:e.MTBRegistrationStatus.Active,l=s?"cancel":"reactivate";return $("<tr>").toggleClass("error",!a).toggleClass("canceled",!s).append($("<td>").text(moment(t.created).format(i.regDateFormat)).attr("title",i.regBy.format(t.createdBy)),$("<td>").text(t.name),$("<td>").text(t.email),$("<td>").text(t.phone),$("<td>").text(t.age||"***"),$("<td>").text(t.accommodation),$("<td>").append($("<a>").addClass("icon style2 "+(s?"fa-close":"fa-check role-admin")).attr("title",i[l+"Reg"]).toggleClass("disabled",!o).click(function(){e.$cmd.exec("delete-registration",$.extend({},t,{force:!1,status:c})).done(function(){t.status=c,c==e.MTBRegistrationStatus.Canceled?r.regcount--:r.regcount++,r.initRegForm(r.event)})}),$("<a>").addClass("icon style2 fa-trash role-admin").attr("title",i.deleteReg).toggleClass("disabled",!o).click(function(){e.$cmd.exec("delete-registration",$.extend({},t,{force:!0})).done(function(){r.registrations=$q(r.registrations).Where(function(e){return e.regId!=t.regId}).ToArray(),r.regcount--,r.initRegForm(r.event)})})))},n.prototype.getReg=function(){var t=this,n={},r=function(e){return $("#reg-"+e,t.pageCnt).val().trim()||null};return n.eventId=this.event.eventId(),n.name=r("name"),n.email=r("email"),n.phone=r("phone"),n.age=parseInt(r("age"))||0,n.accommodation=r("accommodation"),n.status=e.MTBRegistrationStatus.Active,n},n.prototype.validateReg=function(){var e=this,t=this.getReg(),n=function(n){return $("#reg-"+n,e.pageCnt).toggleClass("error",null==t[n])};n("name"),n("email"),n("phone");var r=$("#reg-agreement",this.pageCnt),i=r.is(":checked");return r.toggleClass("error",!i),$("input.error",this.pageCnt).length>0?null:t},n.prototype.submitReg=function(t,n){var r=this,i={template:"registration_"+e.$cfg.lang,to:[{name:n.name,email:n.email}],bcc:e.$cfg.email.bcc||[],location_origin:location.origin},o=e.$ctx.session.current;o&&o.email&&!$q(i.bcc).Any(function(e){return e.email==o.email})&&i.bcc.push({name:o.first_name+" "+o.last_name,email:o.email}),e.$ctx.register(n,t,i).always(function(){return e.$ui.loader.hide()}).done(function(t){r.registrations&&r.registrations.push(t),r.regcount++,r.initUI(r.event),r.setRegMsg(e.$res.event.details.regSuccess,!1)}).fail(function(t){r.setRegMsg(e.$res.event.details.regFail,!0)})},n.prototype.setRegMsg=function(e,t){$("p.msg",this.pageCnt).toggleClass("error",t).toggleClass("success",!t).text(e)},n}(t.Page);t.PageEvent=n}(e.$pages||(e.$pages={}))}($oewr||($oewr={}));var $oewr;!function(e){!function(t){var n=function(t){function n(n,r,i){var o=t.call(this,n,r,i)||this,a=o,s=["type","level","name-de","name-en","short-descr-de","short-descr-en","descr-de","descr-en","requirements-de","requirements-en","from","to"];return $q(s).ForEach(function(e){o[e.replace(/-/g,"_")]=o.input(e)}),o.img=$(".event-img",r).click(function(){$(".event-img.selected",r).removeClass("selected"),$(this).addClass("selected")}),o.input("from").change(function(){a.copyFromDate($(this))}),o.datesTbl=$("table.dates",r),$("a.add-date",o.datesTbl).click(function(){return o.addDate()}),$("a.button.save",o.pageCnt).click(function(){o.save()}),e.$ui.init(r),$(".map",o.pageCnt).data("gmap_promise").done(function(){o.mapMarker=$(".map",o.pageCnt).data("gmap_markers")[0],i.resolve(o)}),o}return __extends(n,t),n.prototype.load=function(t){if(this.pageCnt.attr("mode",this.mode=e.$url.dest||"edit"),"edit"==this.mode){var n=parseInt(e.$url.args.id);if(null==n||isNaN(n))return t.reject("Missing event id!");if(this.event=e.$data.eventMap.Get(n),!this.event)return t.reject("Missing event "+n)}else this.event=new e.MTBEvent({});this.series=this.event.series(),this.initInputFields(this.event),t&&t.resolve(this)},n.prototype.isSeries=function(){return this.series===this.event},n.prototype.initInputFields=function(t){this.input("name-de").val(t.name_de()),this.input("name-en").val(t.name_en());var n=t.type()||e.MTBEventTypes.TechniqueTraining;this.input("type").val(n.name);var r=t.status()||e.MTBEventStatus.TakesPlace;this.input("status").val(e.MTBEventStatus[r]);var i=t.level();this.input("level","[value="+e.MTBLevel[i]+"]").click(),this.input("price-type","[value="+(t.isErlebniscard()?"erlebniscard":"price")+"]").click(),t.isErlebniscard()||this.input("price").val(parseInt(t.price())),this.input("max-participants").val(t.maxParticipants()||("add"==this.mode?6:0)),this.input("allow-reg").val(t.allowReg().toString()),this.input("short-descr-de").val(t.shortDescription_de()),this.input("short-descr-en").val(t.shortDescription_en()),this.input("descr-de").val(t.description_de()),this.input("descr-en").val(t.description_en()),this.input("requirements-de").val(t.requirements_de()),this.input("requirements-en").val(t.requirements_en());var o=t.img(!1);$(".event-img"+(o?"[value='"+o+"']":".first"),this.pageCnt).click(),this.input("meeting-point-description").val(t.meetingPointDescription());var a=new google.maps.LatLng(t.lat(),t.lng());this.mapMarker.setPosition(a);var s=t.from();s&&this.input("from").val(s.format("YYYY-MM-DDTHH:mm"));var c=t.to();c&&this.input("to").val(c.format("YYYY-MM-DDTHH:mm")),this.occurrences=t.occurrences(),$("table.dates tbody",this.pageCnt).toggle(this.isSeries()),$(".add-date",this.pageCnt).toggle(this.isSeries()),$(".button.edit-series",this.pageCnt).attr("href","#/event/edit?id="+t.parentId()).toggle(null!=t.parentId()),$(".button.delete",this.pageCnt).click(function(){e.$cmd.exec("delete-event",{id:t.eventId()}).done(function(){e.$app.hashChange("#/events")})}),this.refreshDatesTbl()},n.prototype.addDate=function(){var t=moment(this.from.val()),n=moment(this.to.val());if(!t.isValid())return alert("Invalid from date!");if(!n.isValid())return alert("Invalid to date!");if($q(this.occurrences).Any(function(r){return r.from().isSame(t)&&r.to().isSame(n)&&r.status()!=e.MTBEventStatus.Deleted}))return alert("Duplicate date");var r=$q(this.series.occurrences()).FirstOrDefault(null,function(e){return e.from().isSame(t)&&e.to().isSame(n)});r&&(r.state.status=e.MTBEventStatus.TakesPlace),this.occurrences.push(r||new e.MTBEvent({from:t.toISOString(),to:n.toISOString()})),this.refreshDatesTbl()},n.prototype.refreshDatesTbl=function(){var t=this;this.occurrences=$q(this.occurrences).Distinct(function(e){return e.from().toISOString()+"-"+e.to().toISOString()}).ToArray();var n=$("tbody",this.datesTbl).empty();$q(this.occurrences).OrderBy(function(e){return e.from()}).ForEach(function(r){r.status()!=e.MTBEventStatus.Deleted&&n.append(t.getDateRow(r))})},n.prototype.getDateRow=function(t){var n=this,r=this;return $("<tr>").data("event",t).append($("<td>").addClass("event-from").text(t.from().format(e.$res.event.edit.dateFormat)).change(function(){r.copyFromDate($(this))}),$("<td>").addClass("event-to").text(t.to().format(e.$res.event.edit.dateFormat)),$("<td>").append($("<a>").addClass("icon style2 fa-repeat").attr("title",e.$res.event.edit.repeat).click(function(){n.from.val(t.from().clone().add(7,"days").format("YYYY-MM-DDTHH:mm")),n.to.val(t.to().clone().add(7,"days").format("YYYY-MM-DDTHH:mm")),n.addDate(),n.refreshDatesTbl()}),$("<a>").addClass("icon style2 fa-pencil mode-edit").click(function(){e.$app.hashChange(e.$res.event.edit.occurrenceUrl.format(t.eventId()))}),$("<a>").addClass("icon style2 fa-minus").click(function(){t.state.status=e.MTBEventStatus.Deleted,n.refreshDatesTbl()})))},n.prototype.copyFromDate=function(t){var n=t.val();if(n){var r=e.MTBEventTypes[this.input("type").val()];t.parent().next().find("input[name=event-to]").val(moment(n).add(r.duration,"hours").format("YYYY-MM-DDTHH:mm"))}},n.prototype.input=function(e,t){return $("[name=event-"+e+"]"+(t||""),this.pageCnt)},n.prototype.getState=function(){if(this.isSeries()&&0==this.occurrences.length)return null;var t;return this.isSeries()?t=this.series?this.series.state:{parentId:null,from:null,to:null}:(t=this.event.state,t.from=moment(this.from.val()).format("YYYY-MM-DDTHH:mm"),t.to=moment(this.to.val()).format("YYYY-MM-DDTHH:mm")),t.type=e.MTBEventTypes[this.input("type").val()].id,t.status=e.MTBEventStatus[this.input("status").val()],t.name=this.input("name-de").val(),t.name_en=this.input("name-en").val(),t.shortDescription=this.input("short-descr-de").val(),t.shortDescription_en=this.input("short-descr-en").val(),t.description=this.input("descr-de").val(),t.description_en=this.input("descr-en").val(),t.requirements=this.input("requirements-de").val(),t.requirements_en=this.input("requirements-en").val(),t.price=this.getPrice(),t.max_participants=parseInt(this.input("max-participants").val()),t.allow_reg=parseInt(this.input("allow-reg").val())||0,t.level=e.MTBLevel[this.input("level",":checked").val()],t.img=$(".event-img.selected",this.pageCnt).attr("value"),t.meeting=this.getMeetingPoint(),t},n.prototype.getOccurrences=function(e){return $q(this.occurrences).Select(function(t){return t.state.parentId=e.eventId(),t.state}).ToArray()},n.prototype.getPrice=function(){return"erlebniscard"==this.input("price-type",":checked").val()?e.MTBEvent.ErlebniscardPrice:this.input("price").val()},n.prototype.getMeetingPoint=function(){var e=this.mapMarker.getPosition(),t=this.input("meeting-point-description").val();return e.lat()+"/"+e.lng()+"/"+t},n.prototype.save=function(){var t=this;0==this.occurrences.length&&this.input("from").val()&&this.input("to").val()&&$("a.add-date",this.pageCnt).click();var n=this.getState();e.$ui.loader.show(),e.$ctx.db.event["add"==this.mode?"insert":"update"](n).done(function(n){if(!t.isSeries())return e.$ui.loader.hide(),e.$data.change(),void("add"==t.mode&&e.$app.hashChange("#/event/edit?id="+n.eventId()));var r=t.getOccurrences(n),i=$q(r).Where(function(e){return null==e.eventId||0==e.eventId}).ToArray(),o=$q(r).Where(function(e){return null!=e.eventId}).ToArray();$.when(i.length?e.$ctx.db.event.insert(i):$.Deferred().resolve().promise(),o.length?e.$ctx.db.event.update(o):$.Deferred().resolve().promise()).done(function(r,i){"add"==t.mode&&(r=[n].concat(r)),r&&r.length?e.$data.addEvent(r):e.$data.change(),"add"==t.mode&&e.$app.hashChange("#/event/edit?id="+n.eventId())}).always(function(){e.$ui.loader.hide()})}).fail(function(){e.$ui.loader.hide()})},n}(t.Page);t.PageEventEdit=n}(e.$pages||(e.$pages={}))}($oewr||($oewr={}));var $oewr;!function(e){!function(t){var n=function(t){function n(n,r,i){var o=t.call(this,n,r,i)||this;return e.$ui.init(r),o.signInBtn=$("#signin-btn",r).click(function(e){e&&e.preventDefault(),o.signIn()}),o.email=$("#signin-email",o.pageCnt),o.pwd=$("#signin-pwd",o.pageCnt),o.errorLbl=$("#signin-error",o.pageCnt),i.resolve(o),o}return __extends(n,t),n.prototype.signIn=function(){var t=this;e.$ui.loader.show(),e.$cmd.exec("signin",{email:this.email.val(),pwd:this.pwd.val(),return:e.$url.args?e.$url.args.return:null}).always(function(){e.$ui.loader.hide(),t.email.val(""),t.pwd.val("")}).done(function(){t.errorLbl.addClass("hidden")}).fail(function(e,n,r){t.errorLbl.text(r).removeClass("hidden")})},n}(t.Page);t.PageSignin=n}(e.$pages||(e.$pages={}))}($oewr||($oewr={}));var $oewr;!function(e){!function(t){var n=function(t){function n(n,r,i){var o=t.call(this,n,r,i)||this;return e.$ui.init(r),i.resolve(o),o}return __extends(n,t),n.prototype.load=function(t){var n=e.$ctx.session.current;if(!n||n.role_id!=e.Roles.Admin)return void t.reject({redirect:"#/signin?return=/admin"});t.resolve(this)},n}(t.Page);t.PageAdmin=n}(e.$pages||(e.$pages={}))}($oewr||($oewr={}));var $oewr;!function(e){!function(t){var n=function(t){function n(e,n,r){var i=t.call(this,e,n,r)||this;return i.title=$("h2.title",i.pageCnt),i.text=$("p.text",i.pageCnt),r.resolve(i),i}return __extends(n,t),n.prototype.load=function(t,n){var r=this;this._result=$.Deferred(),this.result=this._result.promise(),n||(n=e.$url.args),this.title.text(n.title),this.text.text(n.text);var i=$(".actions",this.pageCnt).empty();$q(n.items).ForEach(function(e){var t=e.Key,n=e.Value,o=$("<li>").appendTo(i);$("<a>").addClass("button special").text(n).appendTo(o).click(function(){r._result.resolve(t)})}),i.append($('<li><a href="#poppage" class="button cancel special icon fa-close">'+e.$res.common.cancel+"</a></li>")),e.$ui.link.init(this.pageCnt),t.resolve(this)},n}(t.Page);t.PageChoice=n}(e.$pages||(e.$pages={}))}($oewr||($oewr={}));var $oewr;!function(e){!function(t){var n=function(t){function n(n,r,i){var o=t.call(this,n,r,i)||this;return e.$ui.init(r),o.title=$("h2.title",o.pageCnt),o.text=$("p.text",o.pageCnt),o.okBtn=$(".button.ok",o.pageCnt).click(function(){o._result&&o._result.resolve(!0)}),o.cancelBtn=$(".button.cancel",o.pageCnt).click(function(){o._result&&o._result.resolve(!1)}),i.resolve(o),o}return __extends(n,t),n.prototype.load=function(t,n){n||(n=e.$url.args||{});var r=n.res;r&&(r=e.$util.expandPath(e.$res,r),r.title&&(n.title=r.title),r.text&&(n.text=r.text),r.ok&&(n.ok=r.ok),r.cancel&&(n.cancel=r.cancel)),this._result=$.Deferred(),this.result=this._result.promise(),$("h2",this.pageCnt).text((n.title||"").format(n)),$("p",this.pageCnt).text((n.text||"").format(n)),this.okBtn.attr("href",n.ok||"#poppage"),n.cancel&&this.cancelBtn.attr("href",n.cancel),this.cancelBtn.parent().toggle("info"!=n.mode),e.$ui.link.init(this.pageCnt),t.resolve(this)},n}(t.Page);t.PageConfirm=n}(e.$pages||(e.$pages={}))}($oewr||($oewr={}));var $oewr;!function(e){!function(t){var n=function(t){function n(n,r,i){var o=t.call(this,n,r,i)||this;return e.$ui.init(r),i.resolve(o),o}return __extends(n,t),n.prototype.load=function(t){var n=e.$res.blauesband,r=parseInt(e.$url.dest)||(new Date).getFullYear(),i=r-1964,o=function(e){return $(".bb-"+e)};o("header").text(n.header.format(i)),o("descr").html(n.description.format(i)),o("date").text(e.$util.formatDate(moment(e.$util.nthWeekdayOfMonth(0,1,new Date("2018-08-01"))),n.dateFormat));var a=$("section.classes table tbody",this.pageCnt);a.empty(),$q(n.classes).ForEach(function(e){var t=$("<tr>").append($("<td>").text(e.name),$("<td>").text(-1==e.from?"":r-e.from),$("<td>").text(-1==e.to?"":r-e.to));a.append(t)}),o("poster").attr("src",e.$cfg.root+"img/blauesband/plakat-"+r+".jpg"),t.resolve(this)},n}(t.Page);t.PageBlauesband=n}(e.$pages||(e.$pages={}))}($oewr||($oewr={}));var $oewr;!function(e){!function(t){function n(i,o,u){var f=e.$cfg.pages[i];if(null==f)return $.Deferred().reject("Missing page "+i).fail(function(e){a(e,i,o)}).promise();if(!e.$ctx.session.granted("page/"+i))return o?$.Deferred().reject("Unauthorized page preload "+i).promise():$.Deferred().reject("Unauthorized page load "+i).fail(function(e){a(e,i,o)}).promise();if(f.synname)return n(f.synname,o);var h=p[i];if(!h){var g=$.Deferred().fail(function(e){a(e,i,o)});h=g.promise();var m,v=l(i);if(!v&&!(m=c(i)))return g.reject().promise();v?g.resolve(v):(o||e.$ui.loader.show(),s(i).then(function(e){v=d[i]=new m(i,e,g),m==t.Page&&g.resolve(v)},function(){g.reject()}))}return(p[i]=h.then(function(e){if(!e.load||o)return e;var t=$.Deferred();return e.load(t,u),t}).then(function(t){return r(t,o),e.$ui.loader.hide(),t})).fail(function(e){a(e,i,o)})}function r(n,r,i){t.current||(t.current=n,i||t.stack.push(t.current)),r||(t.current!=n&&(t.current&&(t.current.remOffset(e.$window.scrollTop()),t.current.pageCnt.removeClass("current").addClass("hidden"),t.current.pageCnt.trigger("pagehide")),(t.current=n).pageCnt.addClass("current").removeClass("hidden"),t.current.pageCnt.trigger("pageload"),i||t.stack.push(t.current)),e.$ui.$backBtn.toggleClass("hidden",t.current==l("main")||t.current.pageCnt.hasClass("no-back-btn")))}function i(e){return n(e,!0)}function o(){var n=$.Deferred();if(t.stack.length<2)return n.resolve().promise();t.stack.pop();var i=t.stack[t.stack.length-1];return i||(i=t.get("main")),r(i,!1,!0),e.$ui.scrollToPage(i,void 0,void 0,"immediate",!0,n)}function a(t,n,r){if(e.$ui.loader.hide(),delete p[n],t&&t.redirect)return e.$app.hashChange(t.redirect);r||e.$app.back(),console.error("Could not load page "+n+"! "+t)}function s(t){var n=$("#"+t+".page");return n.length>0?$.Deferred().resolve(n).promise():$.ajax({type:"GET",url:"pages/"+t+".html"}).then(function(r){return r||(r='<div id="'+t+'"></div>'),n=$(r),e.$body.append(n),n})}function c(e){var n=e.split("-");return e=$q(n).Select(function(e){return e[0].toUpperCase()+e.substr(1)}).ToArray().join(""),t["Page"+e]||t.Page}function l(e){return d[e]}function u(t){return null!=e.$cfg.pages[t]}var p={},d={};t.stack=[],t.load=n,t.preload=i,t.back=o,t.get=l,t.exists=u}(e.$pages||(e.$pages={}))}($oewr||($oewr={}));var $oewr;!function(e){!function(t){var n=function(){function t(){}return t.prototype.exec=function(t){var n=t.hash,r=t.email,i=t.pwd;if(!(n||r&&i))return $.Deferred().reject("Missing credentials!").promise();var o=t.return||"#/";return e.$ui.loader.show(),(n?e.$ctx.session.hashauth(n):e.$ctx.session.signin(r,i)).always(function(){e.$ui.loader.hide()}).done(function(t){return e.$app.hashChange(e.$util.ensureStartsWith(o,"#"))}).fail(function(e,t,n){console.error(n)})},t}();t.CmdSignin=n}(e.$cmd||(e.$cmd={}))}($oewr||($oewr={}));var $oewr;!function(e){!function(t){var n=function(){function t(){}return t.prototype.exec=function(t){return e.$ctx.session.signout().always(function(){e.$app.back()}).done(function(){})},t}();t.CmdSignout=n}(e.$cmd||(e.$cmd={}))}($oewr||($oewr={}));var $oewr;!function(e){!function(t){var n=function(){function t(){}return t.prototype.exec=function(t){return e.$ctx.session.agreeCookies(),e.$app.setCookieAgreement(!0),e.$app.back(),$.Deferred().resolve().promise()},t}();t.CmdAgreeCookies=n}(e.$cmd||(e.$cmd={}))}($oewr||($oewr={}));var $oewr;!function(e){!function(t){var n=function(){function t(){}return t.prototype.exec=function(t){var n=parseInt(t.id);if(null==n||isNaN(n))return $.Deferred().reject("Missing id!").promise();var r=e.$data.eventMap.Get(n);return r?e.$app.choice(e.$res.cmdEditEvent).done(function(t){var n="series"==t?r.seriesId():r.eventId();e.$app.hashChange("#/event/edit?id="+n)}):$.Deferred().reject("Missing event with id "+n+"!").promise()},t}();t.CmdEditEvent=n}(e.$cmd||(e.$cmd={}))}($oewr||($oewr={}));var $oewr;!function(e){!function(t){var n=function(){function t(){}return t.prototype.exec=function(t){var n=parseInt(t.id);if(null==n||isNaN(n))return $.Deferred().reject("Missing id!").promise();var r=e.$data.eventMap.Get(n);if(!r)return $.Deferred().reject("Missing event with id "+n+"!").promise();var i=[r];return r.isSeries()&&(i=r.occurrences().concat(r)),e.$app.confirm(e.$res.cmdDeleteEvent.title,e.$res.cmdDeleteEvent.text,t.ok,t.cancel).done(function(t){return e.$ui.loader.show(),e.$ctx.db.event.delete($q(i).Select(function(e){return e.state}).ToArray()).always(function(){e.$ui.loader.hide()}).done(function(t){return e.$data.deleteEvent(t),t})})},t}();t.CmdDeleteEvent=n}(e.$cmd||(e.$cmd={}))}($oewr||($oewr={}));var $oewr;!function(e){!function(t){var n=function(){function t(){}return t.prototype.exec=function(t){var n=t;if(!n||!n.regId)return $.Deferred().reject("Missing reg!").promise();"string"==typeof t.force&&(t.force="true"===t.force);var r="";r=t.force?"Delete":t.status==e.MTBRegistrationStatus.Canceled?"Cancel":"Reactivate";var i=e.$res.cmdDeleteReg["title"+r],o=e.$res.cmdDeleteReg["text"+r].format(n.name),a={template:(t.force||"Cancel"==r?"delete_":"")+"registration_"+e.$cfg.lang,to:[{name:n.name,email:n.email}],bcc:e.$cfg.email.bcc||[],location_origin:location.origin},s=e.$ctx.session.current;return s&&s.email&&!$q(a.bcc).Any(function(e){return e.email==s.email})&&a.bcc.push({name:s.first_name+" "+s.last_name,email:s.email}),e.$app.confirm(i,o,t.ok,t.cancel).done(function(r){return e.$ui.loader.show(),e.$ctx.deleteRegistration(n,t.force,t.status,a).always(function(){e.$ui.loader.hide()})})},t}();t.CmdDeleteRegistration=n}(e.$cmd||(e.$cmd={}))}($oewr||($oewr={}));var $oewr;!function(e){!function(e){function t(t,r){var i=e[n(t)];return i?(new i).exec(r||{}):$.Deferred().reject("Cmd "+t+" not found!").promise()}function n(e){var t=e.split("-");return"Cmd"+(e=$q(t).Select(function(e){return e[0].toUpperCase()+e.substr(1)}).ToArray().join(""))}function r(e){return e&&"cmd"==e.page&&e.dest?t(e.dest,e.args):$.Deferred().reject("Invalid cmd url '"+(e?e.hash:"")+"'").promise()}e.exec=t,e.execUrl=r;var i=function(){function e(){}return e.prototype.exec=function(e){return $.Deferred().resolve().promise()},e}();e.Cmd=i}(e.$cmd||(e.$cmd={}))}($oewr||($oewr={}));var $oewr;!function(e){e.$window=$(window),e.$doc=$(document.documentElement),e.$body=$(document.body),e.$main=$("#main.page");!function(t){function n(t){e.$cfg.init(t),Modernizr.history&&(history.scrollRestoration="manual",f=history.length),e.$window.on("hashchange",function(){h||r()}),Modernizr.history&&e.$window.on("popstate",function(){g||(m=!0)}),l(e.$ctx.session.hasCookieAgreement()),e.$ctx.session.change(function(){c(null!=e.$ctx.session.current)}),e.$ctx.session.refresh().always(function(){e.$data.init(),e.$pages.preload("main").done(function(){r(void 0,void 0,"immediate").done(function(){$q(e.$cfg.pages).Where(function(e){return e.Value.preload}).ForEach(function(t){return e.$pages.preload(t.Key)})})})})}function r(n,r,a){if("#back"===n||"#pophistory"==n||"#poppage"==n)return void t.back(n);if(h=!0,m||(g=!0),e.$url=e.$util.parseUrl(n||window.location.hash),"cmd"==e.$url.page)return e.$cmd.execUrl(e.$url).fail(function(e){return console.error(e),t.back()});var c=e.$pages.current&&e.$url.page!=e.$pages.current.name;n&&window.location.hash!=n&&(c&&(e.$ui.$backBtn.attr("href",window.location.hash),window.location.hash=n),Modernizr.history&&o(n)),c&&(a="immediate",document.title=i(e.$url),m||e.$pages.current.remOffset(e.$window.scrollTop()));var l=e.$url.args;return l&&(l.anchor&&(r=l.anchor),l.speed&&(a=l.speed)),e.$ui.scrollTo(e.$url,r,a,m).fail(function(e){s()}).done(function(){h=g=m=!1})}function i(t){var n=e.$res[t.page],r=t.dest&&n?n[t.dest]:null;return r&&r.title?r.title:n&&n.title?n.title:e.$res.main.title}function o(e){history.replaceState(e,void 0,e)}function a(){r("#/")}function s(t){m=!0,"#back"===t&&(t=null),t||(t=e.$ui.$backBtn.attr("back")||e.$pages.current&&e.$pages.current.defaultBack()||"#/"),"#pophistory"==t?history.back():"#poppage"==t?e.$pages.back().always(function(){m=!1}):r(t).always(function(){m=!1})}function c(t){e.$doc.toggleClass("authenticated",t).toggleClass("unauthenticated",!t).toggleClass("role-public",e.$ctx.session.isPublic()).toggleClass("role-partner",e.$ctx.session.isPartner()).toggleClass("role-admin",e.$ctx.session.isAdmin())}function l(t){e.$doc.toggleClass("missing-cookie-agreement",!t)}function u(t,n,r,i,o){return"string"==typeof t&&(t={title:t,text:n,ok:r,cancel:i}),t.mode=o||"confirm",e.$pages.load("confirm",!1,t).then(function(e){return e.result})}function p(e,t,n){return u(e,t,n,"info")}function d(t,n,r){return"string"==typeof t&&(t={title:t,text:n,items:r}),e.$pages.load("choice",!1,t).then(function(e){return e.result})}var f,h=!1,g=!1,m=!1;t.init=n,t.hashChange=r,t.setHash=o,t.home=a,t.back=s,t.setAuthenticated=c,t.setCookieAgreement=l,t.confirm=u,t.info=p,t.choice=d}(e.$app||(e.$app={})),e.$ui.initSkel()}($oewr||($oewr={}));